{% load humanize madlibs %}
{% if not stat_wrapper == 'false' %}<a class="stat {{ stat_type }}{% if wrapper_class %} {{ wrapper_class }}{% endif %}">{% endif %}
    <span class="{% if stat_class %}{{ stat_class }}{% else %}primary{% endif %}">
        <span class="value">
            {% if not stat.values.this %}
                N/A
            {% else %}
                {% if stat_type == 'dollar' %}${% endif %}{{ stat.values.this|floatformat|intcomma }}{% if stat_type == 'percentage' %}%{% endif %}{% if stat_suffix %} <span class="stat-suffix">{{ stat_suffix }}</span>{% endif %}
                {% if stat.error.this_ratio >= 10 %}<sup>&dagger;</sup>{% endif %}
            {% endif %}

			{% if not stat_class == 'secondary' %}
                {% if stat.error.this %}
                    <span class="context moe">&plusmn;{% if stat_type == 'dollar' %}${% endif %}{{ stat.error.this|floatformat|intcomma }}{% if stat_type == 'percentage' %}%{% endif %}</span>
                {% endif %}

                {% if stat.numerators.this %}
                    <span class="context">({% if stat_type == 'dollar' %}${% endif %}{{ stat.numerators.this|floatformat|intcomma }}&nbsp;&nbsp;&plusmn;{% if stat_type == 'dollar' %}${% endif %}{{ stat.numerator_errors.this|floatformat|intcomma }})</span>
                {% endif %}
			{% endif %}
        </span>
        <span class="name">{{ stat.name }}</span>
		
		{% if stat_class == 'secondary' %}
			<span class="context">
	            {% if stat.error.this %}
	                &plusmn;{% if stat_type == 'dollar' %}${% endif %}{{ stat.error.this|floatformat|intcomma }}{% if stat_type == 'percentage' %}%{% endif %}
	            {% endif %}

	            {% if stat.numerators.this %}
	                <span class="push-right">({% if stat_type == 'dollar' %}${% endif %}{{ stat.numerators.this|floatformat|intcomma }}&nbsp;&nbsp;&plusmn;{% if stat_type == 'dollar' %}${% endif %}{{ stat.numerator_errors.this|floatformat|intcomma }})</span>
	            {% endif %}
			</span>
		{% endif %}
    </span>

    {% if not stat_class == 'secondary' %}
    {% if stat.values.province or stat.values.country %}
    <ul class="context-phrases">
        {% if stat.values.province %}
        <li>
            {% if stat.values.province_index and stat_type != 'count' %}
            {{ stat.values.province_index|comparison_index_phrase }} the {{ stat_type|stat_type_to_number_noun }} in {{ geography.province.short_name }}: {% if stat_type == 'dollar' %}${% endif %}{{ stat.values.province|floatformat|intcomma }}{% if stat_type == 'percentage' %}%{% endif %}
            {% if stat.error.province_ratio >= 10 %}<sup>&dagger;</sup>{% endif %}
            {% else %}
            <strong>{{ geography.province.short_name }}:</strong> {% if stat_type == 'dollar' %}${% endif %}{{ stat.values.province|floatformat|intcomma }}{% if stat_type == 'percentage' %}%{% endif %} 
            {% endif %}
            {% if stat.numerators.province %}
                <span class="context">{% if stat_type == 'dollar' %}${% endif %}{{ stat.numerators.province|floatformat|intcomma }}</span>
                {% if stat.error.province %}
                    <span class="context">(&plusmn;{% if stat_type == 'dollar' %}${% endif %}{{ stat.error.province|floatformat|intcomma }}{% if stat_type == 'percentage' %}%{% endif %}{% if stat.numerator_errors.province %} / &plusmn;{% if stat_type == 'dollar' %}${% endif %}{{ stat.numerator_errors.province|floatformat|intcomma }}{% endif %})</span>
                {% endif %}
            {% elif stat.error.province %}
                <span class="context">&plusmn;{% if stat_type == 'dollar' %}${% endif %}{{ stat.error.province|floatformat|intcomma }}{% if stat_type == 'percentage' %}%{% endif %}</span>
            {% endif %}
        </li>
        {% endif %}
        {% if stat.values.country %}
        <li>
            {% if stat.values.country_index and stat_type != 'count' %}
            {{ stat.values.country_index|comparison_index_phrase }} the {{ stat_type|stat_type_to_number_noun }} countrywide: {% if stat_type == 'dollar' %}${% endif %}{{ stat.values.country|floatformat|intcomma }}{% if stat_type == 'percentage' %}%{% endif %}
            {% if stat.error.country_ratio >= 10 %}<sup>&dagger;</sup>{% endif %}
            {% else %}
            <strong>Countrywide:</strong> {% if stat_type == 'dollar' %}${% endif %}{{ stat.values.country|floatformat|intcomma }}{% if stat_type == 'percentage' %}%{% endif %}
            {% endif %}
            {% if stat.numerators.country %}
                <span class="context">{% if stat_type == 'dollar' %}${% endif %}{{ stat.numerators.country|floatformat|intcomma }}</span>
                {% if stat.error.country %}
                    <span class="context">(&plusmn;{% if stat_type == 'dollar' %}${% endif %}{{ stat.error.country|floatformat|intcomma }}{% if stat_type == 'percentage' %}%{% endif %}{% if stat.numerator_errors.country %} / &plusmn;{% if stat_type == 'dollar' %}${% endif %}{{ stat.numerator_errors.country|floatformat|intcomma }}{% endif %})</span>
                {% endif %}
            {% elif stat.error.country %}
                <span class="context">&plusmn;{% if stat_type == 'dollar' %}${% endif %}{{ stat.error.country|floatformat|intcomma }}{% if stat_type == 'percentage' %}%{% endif %}</span>
            {% endif %}
        </li>
        {% endif %}
    </ul>
    {% endif %}
    {% endif %}
{% if not stat_wrapper == 'false' %}</a>{% endif %}
